<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Release Gate Report - {{ release_id }}</title>
    <style>
        :root {
            --color-ok: #22c55e;
            --color-warn: #eab308;
            --color-block: #ef4444;
            --color-bg: #1a1a2e;
            --color-card: #16213e;
            --color-text: #e2e8f0;
            --color-muted: #94a3b8;
            --color-border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--color-border);
        }

        h1 {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .meta {
            color: var(--color-muted);
            font-size: 0.875rem;
        }

        .verdict-banner {
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .verdict-banner.ok { background: rgba(34, 197, 94, 0.1); border: 1px solid var(--color-ok); }
        .verdict-banner.warn { background: rgba(234, 179, 8, 0.1); border: 1px solid var(--color-warn); }
        .verdict-banner.block { background: rgba(239, 68, 68, 0.1); border: 1px solid var(--color-block); }

        .verdict-text {
            font-size: 2rem;
            font-weight: 700;
        }

        .verdict-text.ok { color: var(--color-ok); }
        .verdict-text.warn { color: var(--color-warn); }
        .verdict-text.block { color: var(--color-block); }

        section {
            background: var(--color-card);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        h2 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        h3 {
            font-size: 1rem;
            font-weight: 600;
            margin: 1.5rem 0 0.75rem 0;
            color: var(--color-muted);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            font-weight: 600;
            color: var(--color-muted);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-ok { color: var(--color-ok); }
        .status-warn { color: var(--color-warn); }
        .status-block { color: var(--color-block); }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-ok { background: rgba(34, 197, 94, 0.2); color: var(--color-ok); }
        .badge-warn { background: rgba(234, 179, 8, 0.2); color: var(--color-warn); }
        .badge-block { background: rgba(239, 68, 68, 0.2); color: var(--color-block); }
        .badge-critical { background: rgba(239, 68, 68, 0.3); color: #fca5a5; }
        .badge-high { background: rgba(234, 179, 8, 0.3); color: #fde047; }
        .badge-medium { background: rgba(59, 130, 246, 0.3); color: #93c5fd; }

        .coverage-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .coverage-bar-fill {
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(90deg, var(--color-ok), var(--color-warn));
        }

        .evidence-list {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.75rem;
            color: var(--color-muted);
        }

        code {
            font-family: 'Monaco', 'Menlo', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }

        .debt-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .debt-card {
            background: rgba(0, 0, 0, 0.2);
            padding: 1rem;
            border-radius: 0.375rem;
        }

        .debt-card-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .debt-card-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-transform: uppercase;
        }

        .justification {
            background: rgba(0, 0, 0, 0.2);
            padding: 1rem;
            border-radius: 0.375rem;
            border-left: 3px solid var(--color-block);
            margin-top: 1rem;
        }

        footer {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--color-border);
            text-align: center;
            color: var(--color-muted);
            font-size: 0.75rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Release Gate Report</h1>
            <div class="meta">
                Release: <strong>{{ release_id }}</strong> |
                Model: <strong>{{ model_version }}</strong> |
                Generated: <strong>{{ generated_at }}</strong>
            </div>
        </header>

        <!-- Verdict Banner -->
        <div class="verdict-banner {{ verdict_class }}">
            <div class="verdict-text {{ verdict_class }}">{{ verdict_emoji }} {{ verdict }}</div>
            <div style="margin-top: 0.5rem; color: var(--color-muted);">{{ verdict_reason }}</div>
        </div>

        <!-- Constitution Audit Section (Key Differentiator) -->
        <section id="constitution-audit">
            <h2>üß≠ Constitution Compliance Audit</h2>

            <table>
                <thead>
                    <tr>
                        <th>Principle</th>
                        <th>Severity</th>
                        <th>Coverage</th>
                        <th>Violations</th>
                        <th>Evidence</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>C1</strong> ‚Äì No Facilitation of Harm</td>
                        <td><span class="badge badge-critical">Critical</span></td>
                        <td>
                            <div class="coverage-bar">
                                <div class="coverage-bar-fill" style="width: 95%; background: var(--color-ok);"></div>
                                <span>95%</span>
                            </div>
                        </td>
                        <td class="status-ok">0</td>
                        <td class="evidence-list">
                            stress_tests:v4<br/>
                            misuse_benchmark:v3<br/>
                            incident_replay:INC-2025-12
                        </td>
                    </tr>
                    <tr>
                        <td><strong>C2</strong> ‚Äì No Deceptive Alignment</td>
                        <td><span class="badge badge-high">High</span></td>
                        <td>
                            <div class="coverage-bar">
                                <div class="coverage-bar-fill" style="width: 70%; background: var(--color-warn);"></div>
                                <span>70%</span>
                            </div>
                        </td>
                        <td class="status-block">3</td>
                        <td class="evidence-list">
                            policy_erosion_detector<br/>
                            misuse_benchmark:PE_01-04
                        </td>
                    </tr>
                    <tr>
                        <td><strong>C3</strong> ‚Äì Preserve Human Oversight</td>
                        <td><span class="badge badge-high">High</span></td>
                        <td>
                            <div class="coverage-bar">
                                <div class="coverage-bar-fill" style="width: 100%; background: var(--color-ok);"></div>
                                <span>100%</span>
                            </div>
                        </td>
                        <td class="status-ok">0</td>
                        <td class="evidence-list">
                            human_escalation_gate<br/>
                            capability_gate
                        </td>
                    </tr>
                    <tr>
                        <td><strong>C4</strong> ‚Äì Uncertainty ‚Üí Caution</td>
                        <td><span class="badge badge-high">High</span></td>
                        <td>
                            <div class="coverage-bar">
                                <div class="coverage-bar-fill" style="width: 90%; background: var(--color-ok);"></div>
                                <span>90%</span>
                            </div>
                        </td>
                        <td class="status-ok">0</td>
                        <td class="evidence-list">
                            statistical_power_gate<br/>
                            power: 0.85
                        </td>
                    </tr>
                    <tr>
                        <td><strong>C5</strong> ‚Äì Continuous Improvement</td>
                        <td><span class="badge badge-medium">Medium</span></td>
                        <td>
                            <div class="coverage-bar">
                                <div class="coverage-bar-fill" style="width: 100%; background: var(--color-ok);"></div>
                                <span>100%</span>
                            </div>
                        </td>
                        <td class="status-ok">0</td>
                        <td class="evidence-list">
                            incident_to_regression: 100%<br/>
                            repeat_incident: 0%
                        </td>
                    </tr>
                    <tr>
                        <td><strong>C6</strong> ‚Äì Transparency & Traceability</td>
                        <td><span class="badge badge-medium">Medium</span></td>
                        <td>
                            <div class="coverage-bar">
                                <div class="coverage-bar-fill" style="width: 100%; background: var(--color-ok);"></div>
                                <span>100%</span>
                            </div>
                        </td>
                        <td class="status-ok">0</td>
                        <td class="evidence-list">
                            evidence_lineage: complete<br/>
                            audit_package: generated
                        </td>
                    </tr>
                </tbody>
            </table>

            <h3>Constitution Reference</h3>
            <code>constitution@2026.02#{{ constitution_hash }}</code>

            <div class="justification">
                <strong>Gate Justification:</strong><br/>
                {{ gate_justification }}
            </div>
        </section>

        <!-- Alignment Debt Section -->
        <section id="alignment-debt">
            <h2>üìä Alignment Debt Status</h2>

            <div class="debt-summary">
                <div class="debt-card">
                    <div class="debt-card-value status-warn">0.12</div>
                    <div class="debt-card-label">Current Debt</div>
                </div>
                <div class="debt-card">
                    <div class="debt-card-value">+0.02</div>
                    <div class="debt-card-label">Œî This Release</div>
                </div>
                <div class="debt-card">
                    <div class="debt-card-value">WARN</div>
                    <div class="debt-card-label">Debt Status</div>
                </div>
                <div class="debt-card">
                    <div class="debt-card-value">3</div>
                    <div class="debt-card-label">Active Entries</div>
                </div>
            </div>

            <h3>Active Debt Entries</h3>
            <table>
                <thead>
                    <tr>
                        <th>Debt ID</th>
                        <th>Principle</th>
                        <th>Description</th>
                        <th>Severity</th>
                        <th>Amount</th>
                        <th>ETA</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>AD-2026-01</td>
                        <td>C2</td>
                        <td>Policy erosion detector coverage gap</td>
                        <td><span class="badge badge-high">High</span></td>
                        <td>0.05</td>
                        <td>2026-03-15</td>
                    </tr>
                    <tr>
                        <td>AD-2026-02</td>
                        <td>C4</td>
                        <td>Statistical power override (v2.4.0)</td>
                        <td><span class="badge badge-high">High</span></td>
                        <td>0.05</td>
                        <td>2026-02-28</td>
                    </tr>
                    <tr>
                        <td>AD-2026-03</td>
                        <td>C2</td>
                        <td>Evaluation gaming detection limited</td>
                        <td><span class="badge badge-medium">Medium</span></td>
                        <td>0.02</td>
                        <td>2026-Q2</td>
                    </tr>
                </tbody>
            </table>

            <h3>Debt Thresholds</h3>
            <div style="display: flex; gap: 2rem; margin-top: 0.5rem;">
                <div><span class="status-ok">‚óè</span> OK: &lt; 0.10</div>
                <div><span class="status-warn">‚óè</span> WARN: &lt; 0.25</div>
                <div><span class="status-block">‚óè</span> BLOCK: &lt; 0.50</div>
            </div>
        </section>

        <!-- Regression Metrics Section -->
        <section id="metrics">
            <h2>üìà Regression Metrics</h2>

            <table>
                <thead>
                    <tr>
                        <th>Suite</th>
                        <th>Metric</th>
                        <th>Baseline</th>
                        <th>Candidate</th>
                        <th>Delta</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>misuse</td>
                        <td>violation_rate</td>
                        <td>8.2%</td>
                        <td>12.5%</td>
                        <td class="status-block">+4.3%</td>
                        <td><span class="badge badge-block">BLOCK</span></td>
                    </tr>
                    <tr>
                        <td>redteam</td>
                        <td>delayed_failure_rate</td>
                        <td>21%</td>
                        <td>34%</td>
                        <td class="status-block">+13%</td>
                        <td><span class="badge badge-block">BLOCK</span></td>
                    </tr>
                    <tr>
                        <td>trajectory</td>
                        <td>policy_erosion_slope</td>
                        <td>0.12</td>
                        <td>0.18</td>
                        <td class="status-warn">+0.06</td>
                        <td><span class="badge badge-warn">WARN</span></td>
                    </tr>
                    <tr>
                        <td>trajectory</td>
                        <td>avg_first_failure</td>
                        <td>4.2</td>
                        <td>3.8</td>
                        <td class="status-warn">-0.4</td>
                        <td><span class="badge badge-warn">WARN</span></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Evidence Lineage Section -->
        <section id="lineage">
            <h2>üîó Evidence Lineage</h2>

            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Version</th>
                        <th>Hash</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Model</td>
                        <td>{{ model_version }}</td>
                        <td><code>sha256:{{ model_hash }}</code></td>
                    </tr>
                    <tr>
                        <td>Constitution</td>
                        <td>2026.02</td>
                        <td><code>sha256:{{ constitution_hash }}</code></td>
                    </tr>
                    <tr>
                        <td>Stress Tests</td>
                        <td>v4</td>
                        <td><code>sha256:{{ stress_tests_hash }}</code></td>
                    </tr>
                    <tr>
                        <td>Misuse Benchmark</td>
                        <td>v3</td>
                        <td><code>sha256:{{ misuse_benchmark_hash }}</code></td>
                    </tr>
                    <tr>
                        <td>Safeguards Config</td>
                        <td>v0.3</td>
                        <td><code>sha256:{{ safeguards_hash }}</code></td>
                    </tr>
                    <tr>
                        <td>Evaluation Run</td>
                        <td>{{ eval_run_id }}</td>
                        <td><code>sha256:{{ eval_run_hash }}</code></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Human Review Section (if applicable) -->
        <section id="human-review" style="display: {{ show_human_review }};">
            <h2>üë§ Human Review Required</h2>

            <div style="background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 0.375rem; border: 1px solid var(--color-block);">
                <strong>Review Tier:</strong> {{ review_tier }}<br/>
                <strong>SLA:</strong> {{ review_sla }} hours<br/>
                <strong>Escalation Path:</strong> {{ escalation_path }}<br/>
                <strong>Override requires:</strong> Safety Lead + VP Engineering approval
            </div>
        </section>

        <footer>
            <p>Generated by Model Safety Regression Suite v2.0</p>
            <p>Constitution: <code>{{ constitution_hash }}</code> | Report: <code>{{ report_hash }}</code></p>
            <p>This report is part of the official release audit trail.</p>
        </footer>
    </div>
</body>
</html>
